name: Replace Word in YAML

on:
  push:
    branches:
      - main

jobs:
  replace-word:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Extract word from commit message
        id: extract-word
        run: |
          # Get the commit message of the latest commit
          commit_message=$(git log --format=%B -n 1 ${{ github.sha }})
          
          # Extract the word from the commit message (considering format: "Replace 'old_word' with 'new_word'")
          user_word=$(echo "$commit_message" | grep -oP "(?<=with ')[^']+")
          
          # Use the extracted word in the sed command to replace
          sed -i "s/old_word/$user_word/g" file.txt
